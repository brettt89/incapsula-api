getStatus:
  post:
    tags:
      - sites
    summary: Get site status
    description: Use this operation to get the status of a site
    operationId: getStatus
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - site_id
            properties:
              site_id:
                description: Numeric identifier of the site to operate on
                type: integer
              tests:
                description: 'Optional tests to run on site before returning its status. A comma separated list of one of: domain_validation, services, dns. See detailed description below.'
                type: string
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              $ref: 'models.yaml#/Site'

addSite:
  post:
    tags:
      - sites
    summary: Add a new site to an account
    description: If the site already exists, its status is returned
    operationId: addSite
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - domain
            properties:
              domain:
                description: 'The domain name of the site. For example: www.example.com, hello.example.com, example.com'
                type: string
              account_id:
                description: 'Numeric identifier of the account to operate on. If not specified, operation will be performed on the account identified by the authentication parameters'
                type: integer
              ref_id:
                description: Customer specific identifier for this operation
                type: string
              send_site_setup_emails:
                description: If this value is "false", end users will not get emails about the add site process such as "DNS instructions" and "SSL setup"
                type: boolean
              site_ip:
                description: Manually set the web server IP/CNAME
                type: string
              force_ssl:
                description: 'If this value is "true", manually set the site to support SSL. This option is only available for sites with manually configured IP/CNAME and for specific accounts'
                type: boolean
              naked_domain_san:
                description: 'Use “true” to add the naked domain SAN to a www site’s SSL certificate. Default value: true'
                type: boolean
              wildcard_san:
                description: 'Use “true” to add the wildcard SAN or “false” to add the full domain SAN to the site’s SSL certificate. Default value: true'
                type: boolean
              log_level:
                description: 'Available only for customers that purchased the Logs Integration SKU. Sets the log reporting level for the site. Options are “full”, “security”, “none” and "default"'
                type: string
              logs_account_id:
                description: 'Available only for customers that purchased the Logs Integration SKU. Numeric identifier of the account that purchased the logs integration SKU and which collects the logs. If not specified, operation will be performed on the account identified by the authentication parameters'
                type: integer
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              $ref: 'models.yaml#/Site'

getDomainApproverEmails:
  post:
    tags:
      - sites
    summary: Get domain approver email addresses
    description: Use this operation to get the list of email addresses that can be used when adding an SSL site.
    operationId: getDomainApproverEmails
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - domain
            properties:
              domain:
                description: 'The domain name of the site. For example: www.example.com, hello.example.com, example.com'
                type: string
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object

modifySiteConfig:
  post:
    tags:
      - sites
    summary: Modify site configuration
    description: Use this operation to change one of the basic configuration settings of the site.
    operationId: modifySiteConfig
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - site_id
            properties:
              site_id:
                description: Numeric identifier of the site to operate on
                type: integer
              param:
                description: Name of configuration parameter to set
                type: string
              value:
                description: According to the param value
                type: string
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object
              minProperties: 2

modifyResponseHeaders:
  post:
    tags:
      - sites
    summary: Modify cached response headers
    description: Use this operation to modify cached response headers
    operationId: modifyResponseHeaders
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - site_id
            properties:
              site_id:
                description: Numeric identifier of the site to operate on
                type: integer
              cache_headers:
                description: Comma separated list of header names to be cached
                type: string
              cache_all_headers:
                description: 'Cache all response headers. Pass "true" or "false" in the value parameter. Cannot be selected together with cache_headers'
                type: string
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object
              minProperties: 2

getResponseHeaders:
  post:
    tags:
      - sites
    summary: Get cached response headers
    description: Use this operation to get a site's cached response headers
    operationId: getResponseHeaders
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - site_id
            properties:
              site_id:
                description: Numeric identifier of the site to operate on
                type: integer
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object
              minProperties: 2

modifyTaggedResponseHeader:
  post:
    tags:
      - sites
    summary: Tag the response according to the value of a header
    description: Specify which origin response header contains the cache tags in your resources
    operationId: modifyTaggedResponseHeader
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - site_id
              - header
            properties:
              site_id:
                description: Numeric identifier of the site to operate on
                type: integer
              header:
                description: 'Specify which origin response header contains the cache tags in your resources. default: ""'
                type: string
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object
              minProperties: 2

getTaggedResponseHeader:
  post:
    tags:
      - sites
    summary: Get Header to Tag Responses By
    description: Use this operation to get the origin response header containing the cache tags in your resources.
    operationId: getTaggedResponseHeader
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - site_id
            properties:
              site_id:
                description: Numeric identifier of the site to operate on
                type: integer
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object
              minProperties: 3

purgeHostname:
  post:
    tags:
      - sites
    summary: Purge hostname from cache
    description: "Use this operation to purge the hostname from the cache.\n\n
This API is for customers who use the same CNAME provided by Imperva for multiple hostnames and would like to change the CNAME for a particular hostname. Purging the hostname is required for the CNAME change to take effect"
    operationId: purgeHostname
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - host_name
            properties:
              host_name:
                description: The hostname to purge from the cache
                type: string
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object
              minProperties: 2

getXrayLink:
  post:
    tags:
      - sites
    summary: Get XRay access link
    description: Use this operation to get a URL that enables debug headers on a specific site
    operationId: getXrayLink
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - site_id
            properties:
              site_id:
                description: Numeric identifier of the site to operate on
                type: integer
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object
              minProperties: 3

addCacheRule:
  post:
    tags:
      - sites
    summary: Add cache rule
    description: Use this operation to add a cache rule
    operationId: addCacheRule
    requestBody:
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            required:
              - site_id
              - host_name
            properties:
              site_id:
                description: Numeric identifier of the site to operate on
                type: integer
              host_name:
                description: The hostname to purge from the cache
                type: string
    responses:
      '200':
        description: Successful response
        content:
          application/json:
            schema:
              type: object
              minProperties: 2
